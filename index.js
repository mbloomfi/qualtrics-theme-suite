function openPreferences(){null===global.sharedObject.preferencesWindow&&(global.sharedObject.preferencesWindow=new BrowserWindow({width:800,height:486,"always-on-top":!0,fullscreen:!1,resizable:!1,frame:!1}),mainWindow.webContents.executeJavaScript("dimmer.on();"),global.sharedObject.preferencesWindow.loadUrl("file://"+__dirname+"/preferences.html"),global.sharedObject.preferencesWindow.on("close",function(){mainWindow.webContents.executeJavaScript("dimmer.off();"),global.sharedObject.preferencesWindow=null}))}function setEditorPreviewRatio(e){var t=global.sharedObject.menuStatus.currentEditorPreviewRatio;appMenu.items[5].submenu.items[0].submenu.items[t].checked=!1,appMenu.items[5].submenu.items[0].submenu.items[e].checked=!0,global.sharedObject.menuStatus.currentEditorPreviewRatio=e,mainWindow.webContents.executeJavaScript("editorPreviewBar.set("+e+");")}var app=require("app"),BrowserWindow=require("browser-window"),gulp=require("gulp"),Menu=require("menu");global.sharedObject={canQuit:!1,menuStatus:{devToolsOpen:!1,currentEditorPreviewRatio:3},preferencesWindow:null};var menuTemplate=[{label:"QTS",submenu:[{label:"About QTS",selector:"orderFrontStandardAboutPanel:"},{type:"separator"},{label:"Preferences...",accelerator:"Command+,",click:function(){openPreferences()}},{type:"separator"},{label:"Hide Electron",accelerator:"Command+H",selector:"hide:"},{label:"Hide Others",accelerator:"Command+Shift+H",selector:"hideOtherApplications:"},{label:"Show All",selector:"unhideAllApplications:"},{type:"separator"},{label:"Quit",accelerator:"Command+Q",selector:"terminate:"}]},{label:"Project",submenu:[{label:"Recent Projects",submenu:[{label:"underarmour (underarmour2 new)"},{label:"ferrari (ferrari_SPA)"},{label:"instagram (moments1)"}]},{label:"Project Files",submenu:[{label:"(empty)"}]},{type:"separator"},{label:"Duplicate Project"},{type:"separator"},{label:"Project Mode",enabled:!1},{label:"Edit/Preview",type:"checkbox",checked:!0,accelerator:"Shift+Command+E"},{label:"Upload (Release Manager)",type:"checkbox",checked:!1,accelerator:"Shift+Command+U"}]},{label:"Edit",submenu:[{label:"Undo",accelerator:"Command+Z",selector:"undo:"},{label:"Redo",accelerator:"Shift+Command+Z",selector:"redo:"},{type:"separator"},{label:"Cut",accelerator:"Command+X",selector:"cut:"},{label:"Copy",accelerator:"Command+C",selector:"copy:"},{label:"Paste",accelerator:"Command+V",selector:"paste:"},{label:"Select All",accelerator:"Command+A",selector:"selectAll:"}]},{label:"Snippets",submenu:[{label:"Recent Snippets",submenu:[]},{type:"separator"},{label:"Snippets Library",accelerator:"Shift+Command+S"},{label:"Key Bindings",accelerator:"Shift+Command+K"}]},{label:"Preview",submenu:[{label:"Preview File",submenu:[{label:"v4 Vertical",type:"checkbox",checked:!0},{label:"v4 Horizontal",type:"checkbox",checked:!1},{label:"v4 Full",type:"checkbox",checked:!1},{type:"separator"},{label:"v3 Vertical",type:"checkbox",checked:!1},{label:"v3 Horizontal",type:"checkbox",checked:!1},{label:"v3 Full",type:"checkbox",checked:!1}]},{type:"separator"},{label:"Preview Mode",enabled:!1},{label:"Regular",accelerator:"Command+0"},{label:"Mobile",accelerator:"Command+1"},{label:"Screenshot",accelerator:"Command+2"},{label:"Thumbnail",accelerator:"Command+3"}]},{label:"Window",submenu:[{label:"Editor/Preview Size Ratio",submenu:[{label:"Editor 10% | Preview 90%",type:"checkbox",checked:!1,click:function(){setEditorPreviewRatio(0)}},{label:"Editor 20% | Preview 80%",type:"checkbox",checked:!1,click:function(){setEditorPreviewRatio(1)}},{label:"Editor 30% | Preview 70%",type:"checkbox",checked:!1,click:function(){setEditorPreviewRatio(2)}},{label:"Editor 40% | Preview 60%",type:"checkbox",checked:!0,click:function(){setEditorPreviewRatio(3)}},{label:"Editor 50% | Preview 50%",type:"checkbox",checked:!1,click:function(){setEditorPreviewRatio(4)}},{label:"Editor 60% | Preview 40%",type:"checkbox",checked:!1,click:function(){setEditorPreviewRatio(5)}},{label:"Editor 70% | Preview 30%",type:"checkbox",checked:!1,click:function(){setEditorPreviewRatio(6)}},{label:"Editor 80% | Preview 20%",type:"checkbox",checked:!1,click:function(){setEditorPreviewRatio(7)}},{label:"Editor 90% | Preview 10%",type:"checkbox",checked:!1,click:function(){setEditorPreviewRatio(8)}},{type:"separator"},{label:"Select Previous",accelerator:"Alt+Command+Left",click:function(){var e=global.sharedObject.menuStatus.currentEditorPreviewRatio;e>0&&setEditorPreviewRatio(e-1)}},{label:"Select Next",accelerator:"Alt+Command+Right",click:function(){var e=global.sharedObject.menuStatus.currentEditorPreviewRatio;8>e&&setEditorPreviewRatio(e+1)}},{type:"separator"},{label:"Select Previous (2x)",accelerator:"Control+Alt+Command+Left",click:function(){var e=global.sharedObject.menuStatus.currentEditorPreviewRatio;1===e?setEditorPreviewRatio(e-1):e>1&&setEditorPreviewRatio(e-2)}},{label:"Select Next (2x)",accelerator:"Control+Alt+Command+Right",click:function(){var e=global.sharedObject.menuStatus.currentEditorPreviewRatio;7===e?setEditorPreviewRatio(e+1):7>e&&setEditorPreviewRatio(e+2)}}]},{type:"separator"},{label:"Toggle Developer Tools",accelerator:"Alt+Command+J",click:function(){global.sharedObject.devToolsOpen?(mainWindow.webContents.executeJavaScript("el('#preview').closeDevTools();"),global.sharedObject.devToolsOpen=!1):(mainWindow.webContents.executeJavaScript("el('#preview').openDevTools();"),global.sharedObject.devToolsOpen=!0)}},{label:"* Electron Developer Tools",accelerator:"Alt+Command+C",click:function(){mainWindow.toggleDevTools()}}]},{label:"Help",submenu:[{label:"Write"}]}],appMenu=Menu.buildFromTemplate(menuTemplate),mainWindow=null;app.on("window-all-closed",function(){app.quit()}),app.on("ready",function(){Menu.setApplicationMenu(appMenu),mainWindow=new BrowserWindow({width:1600,height:900}),mainWindow.loadUrl("file://"+__dirname+"/index.html"),mainWindow.on("close",function(e){global.sharedObject.canQuit?console.log("Application Terminated. Good bye."):(e.preventDefault(),mainWindow.webContents.executeJavaScript("Quitter.prompt();"),console.log("Prompting for Quit"))}),gulp.task("reload",function(){setTimeout(function(){mainWindow.reload(),global.sharedObject.preferencesWindow&&global.sharedObject.preferencesWindow.reload()},500)}),gulp.task("watch",function(){gulp.watch("index.html",["reload"])}),gulp.tasks.watch.fn()});