<!DOCTYPE html>
<html class="white">

<head>
	<meta name="QTS Preferences" charset="UTF-8">
	<title>QTS Preferences</title>

	<style>
		@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;src:url(local/fonts/SourceSansPro-Regular.otf)}@font-face{font-family:'Source Sans Pro';font-style:italic;font-weight:400;src:url(local/fonts/SourceSansPro-It.otf)}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:600;src:url(local/fonts/SourceSansPro-Bold.otf)}@font-face{font-family:'Source Sans Pro';font-style:italic;font-weight:600;src:url(local/fonts/SourceSansPro-BoldIt.otf)}a,body,button,div,h1,h2,html,input,label,p,section,select,span,textarea{padding:0;margin:0;border:none;border-radius:0;outline:0;font-size:100%;color:#464646;text-decoration:none;font-weight:400;font-family:"Source Sans Pro","Helvetica Neue"}#bottom-bar div.btn,nav#nav div.nav_option{box-sizing:border-box;color:#fff;text-transform:uppercase}body,html{width:100%;height:100%;position:relative;overflow:hidden;background-color:#ebebeb;-webkit-user-select:none;-webkit-app-region:no-drag;-webkit-transition:background-color .3s ease;transition:background-color .3s ease}body.white,html.white{background-color:#fff}img.logo{height:80px;position:absolute;top:0;right:0;z-index:100;padding:0 30px 5px 0;-webkit-app-region:drag;cursor:default;-webkit-filter:saturate(0) opacity(.14);filter:saturate(0) opacity(.14);-webkit-transition:top .3s ease;transition:top .3s ease}img.logo.hide{top:-100px}#bottom-bar{height:30px;width:100%;position:absolute;bottom:0;left:0;box-sizing:border-box;text-align:center;line-height:30px;-webkit-transition:bottom .3s ease;transition:bottom .3s ease}#bottom-bar div.btn{-webkit-app-region:no-drag;height:100%;width:50%;position:absolute;top:0;cursor:pointer;-webkit-transition:background-color .25s ease;transition:background-color .25s ease}#bottom-bar div.btn:first-child{left:0;background-color:#df4848;border-right:1px solid #5f5f5f}#bottom-bar div.btn:first-child:hover{background-color:#f55550}#bottom-bar div.btn:last-child{right:0;background-color:#28b432}#bottom-bar div.btn:last-child:hover{background-color:#32c837}#bottom-bar.hide{bottom:-60px}#preferences-wrapper{height:500px;width:100%;position:relative;top:0}nav#nav{height:100%;width:25%;position:absolute;top:0;left:0;-webkit-transition:left .3s ease;transition:left .3s ease}nav#nav div.nav_option{position:relative;-webkit-app-region:no-drag;height:100px;background:#3c3c3c;width:100%;line-height:100px;padding:0 0 0 20px;font-size:32px;cursor:pointer;z-index:10;-webkit-transition:width .25s ease,background .25s ease,color .25s ease;transition:width .25s ease,background .25s ease,color .25s ease}nav#nav div.nav_option:hover{background:#5a5a5a}nav#nav div.nav_option.current{width:107%;background-color:#787878}nav#nav.hide{left:-300px}section#panel{position:absolute;top:0;right:0;height:100%;width:75%;opacity:1;font-size:1.75em;-webkit-transition:opacity .3s ease;transition:opacity .3s ease}section#panel div#preferences_splash{height:100%;line-height:500px;font-size:2em;text-align:center;color:#c8c8c8}section#panel form{position:relative;z-index:10;width:70%;left:10%;top:10%;-webkit-app-region:no-drag}section#panel form h2{margin:0 0 5px}section#panel form div.fieldSet{width:100%;margin:0 0 15px}section#panel form div.fieldSet:after{content:"";display:block;clear:both}section#panel form input{font-size:21px;padding:3px 0;display:block;min-width:90%;outline:#d7d7d7 solid 2px;margin:0 0 15px;text-indent:2px;border:none;-webkit-transition:outline .25s ease;transition:outline .25s ease}section#panel form input:focus{outline-offset:0;outline:#bebebe solid 2px}section#panel form input.thumbnailName{width:40%;display:inline-block;min-width:50%;margin:0 10px 0 0;float:left}section#panel form label.radioLabel{display:block;line-height:1;padding:0;margin:0 0 5px;font-size:18px}section#panel form label.radioLabel input{padding:0;display:inline-block;margin:0 0 0 10px;background:0 0;outline:0;height:15px;width:15px}section#panel form label.radioLabel span{font-size:14px}section#panel form button{font-size:16px;background-color:#6e6e6e;color:#fff;padding:5px 10px;cursor:pointer;display:block}section#panel form button:hover{background-color:#5a5a5a}section#panel form div.select_cont{width:90%;background-color:#fff;outline:#d7d7d7 solid 2px}section#panel form div.select_cont select{display:block;font-size:18px;height:30px;width:100%;margin:0 0 20px;text-indent:2px;background:0 0}section#panel form div.select_cont.inline-block{width:25%;float:left;height:33px;display:inline-block}section#panel form div.select_cont.inline-block select{display:block;font-size:18px;height:auto;width:100%;margin:0;text-indent:2px;background:0 0}section#panel form#preferences_form{padding:50px 0 0}section#panel.hide{opacity:0}section#Prompter{position:fixed;top:-120px;left:0;background:#242424;color:#fff;height:60px;width:100%;border-bottom:4px solid #df4848;box-shadow:0 10px 35px rgba(0,0,0,.5);z-index:10;-webkit-transition:top .5s ease;transition:top .5s ease}section#Prompter.show{top:0;-webkit-transition:top .25s ease;transition:top .25s ease}section#Prompter .message{color:inherit;font-weight:700;height:100%;position:relative;float:left;line-height:60px;margin:0 30px;font-size:1.75em}section#Prompter .btn{color:inherit;height:48px;position:relative;top:6px;float:left;line-height:48px;background:orange;padding:0 15px;font-size:1.25em;cursor:pointer;text-align:center;min-width:50px;background-color:rgba(255,255,255,.15);-webkit-transition:background-color .3s ease;transition:background-color .3s ease}section#Prompter .mainBtn{background-color:rgba(223,72,72,.85)}section#Prompter .mainBtn:hover{background-color:#eb5454}section#Prompter .btn2{margin:0 20px 0 0}section#Prompter .btn2:hover{background-color:rgba(255,255,255,.3)}div.overlay{position:fixed;top:0;left:0;height:100%;width:100%;background-color:rgba(0,0,0,.3);z-index:9;opacity:0;-webkit-transition:opacity .3s ease;transition:opacity .3s ease}div.overlay.visible{opacity:1}

	</style>
		
</head>

<body class="white">

	<img id="logo" class="logo hide" src="local/images/qualtrics_logo.png">

	<section id="bottom-bar" class="hide">
		<div id="cancel" class="btn">cancel</div>
		<div id="save" class="btn">save</div>
	</section>

	<section id="preferences-wrapper">

		<nav id="nav" class="hide">
			<div id="QTS-option" class="nav_option">QTS</div>
			<div id="files-option" class="nav_option">Files</div>
			<div id="snippets-option" class="nav_option">Snippets</div>
			<div id="preview-option" class="nav_option">Preview</div>
			<div id="window-option" class="nav_option">Window</div>
		</nav>

		<section id="panel" class="hide">

			<div id="preferences_splash">PREFERENCES</div>

		</section>

	</section>

<script type="text/javascript">
	function checkAndRadio(){el(document.querySelectorAll("input[type=radio]"))}!function(){el=function(e,t){function n(e){var n=e.charAt(0);switch(n){case"#":return r.getById(e.slice(1));case"+":if(e.slice(1).match(/#/)){var a=e.slice(1).split("#"),l=r.create(a[0],t);return el.isElementArray(l)?l.each(function(e){e.setAttribute("id",a[1])}):l.setAttribute("id",a[1]),l}return r.create(e.slice(1),t);case".":return r.getByClassName(e.slice(1));default:return r.getByTagName(e)}}var r=this===window?window.el:this;return"string"==typeof e?n(e):el.isElement(e)?el.elify(e):el.isCollection(e)||el.isNodeList(e)||el.isElementArray(e)?el.elify(e):void 0},el.create=function(e,t){if(t&&"number"==typeof t){for(var n=[],r=0,a=t;a>r;r++)n.push(el.elify(document.createElement(e)));return n}return el.elify(document.createElement(e))},el.getById=function(e){if(this===window.el)return el.elify(document.getElementById(e));if(el.isElement(this)){if(document.contains(this))return el.elify(document.getElementById(e));var t=this,n=!1,r=null;return t.el("*").each(function(t){return t.getAttribute("id")===e?(n=!0,r=t,0):void 0}),r}},el.getByClassName=function(e,t){var n=this===window.el?document:this,r=n.getElementsByClassName(e);return r=Array.prototype.slice.call(r),el.elify(r)},el.getByTagName=function(e,t){var n=this===window.el?document:this,r=n.getElementsByTagName(e);return r=Array.prototype.slice.call(r),el.elify(r)},el.on=function(e,t){var n=el.isElement(this)||el.isElementArray(this)?this:window;return n.addEventListener(e,t),this},el.join=function(e){var t=[];if(el.isArray(e))for(var n=0,r=e.length;r>n;n++)el.isElement(e[n])?t.push(e[n]):el.isElementArray(e[n])&&e[n].each(function(e){t.push(e)});return el.elify(t)},el.elify=function(e){function t(e){return e.el=el,e.getById=el.getById,e.getByClassName=el.getByClassName,e.getByTagName=el.getByTagName,e.getByAttribute=el.getByAttribute,e.elify=el.elify,e.on=el.on,e.addClass=function(e){var t=this;if(el.isArray(e))for(var n=0,r=e.length;r>n;n++)t.classList.add(e[n]);else"string"==typeof e&&t.classList.add(e);return t},e.rmClass=function(e){var t=this;if(el.isArray(e))for(var n=0,r=e.length;r>n;n++)t.classList.remove(e[n]);else"string"==typeof e&&t.classList.remove(e);return t},e.hasClass=function(e){return this.classList.contains(e)},e.rm=function(){var e=this;return e.parentNode&&e.parentNode.removeChild(e),e},e.append=function(e){if(el.isElementArray(e)){var n=document.createDocumentFragment();e.each(function(e){e.el||(e=t(e)),n.appendChild(e)}),e=n}return this.appendChild(e),this},e.appendTo=function(e){var t=this;return el.isElementArray(e)?e.each(function(e){var n=t.cloneNode(!0);e.appendChild(n)}):e.appendChild(t),t},e.purge=function(){for(var e=this;e.firstChild;)e.removeChild(e.firstChild);return e},Object.defineProperty(e,"text",{configurable:!0,enumerable:!0,writable:!0,value:function(t){return"string"==typeof t&&e.appendChild(document.createTextNode(t)),e}}),e.attr=function(e,t){return"string"==typeof e&&this.setAttribute(e,void 0!==t?t:""),this},e}return el.isElement(e)?t(e):((el.isCollection(e)||el.isNodeList(e))&&(e=Array.prototype.slice.call(e)),e.each=function(e){for(var t=this,n=0,r=t.length;r>n;n++)if(0===e(t[n],n,t))return this===window.el?void 0:this;return this===window.el?void 0:this},e.each(function(e){t(e)}),e.addClass=function(n){return e.each(function(e){"undefined"!=typeof e&&(e.el||(e=t(e)),e.addClass(n))}),e},e.rmClass=function(n){return e.each(function(e){"undefined"!=typeof e&&(e.el||(e=t(e)),e.rmClass(n))}),e},e.hasClass=function(n,r){if("all"===r||"undefined"==typeof r){var a=!0;return e.each(function(e){"undefined"!=typeof e&&(void 0===e.el&&(e=t(e)),e.hasClass(n)||(a=!1))}),a}return"any"===r?(e.each(function(e){return"undefined"!=typeof e&&(e.el||(e=t(e)),e.hasClass(n))?!0:void 0}),!1):e},e.rm=function(n){return this.each(function(e){"undefined"!=typeof e&&(e.el||(e=t(e)),e.rm())}),e},e.append=function(n){if(el.isElementArray(n)){var r=document.createDocumentFragment();n.each(function(e){void 0===e.el&&(e=t(e)),r.appendChild(e)}),n=r}return e.each(function(e){"undefined"!=typeof e&&(e.el||(e=t(e)),e.append(n.cloneNode(!0)))}),e},e.appendTo=function(n,r){return e.each(function(e){"undefined"!=typeof e&&(void 0===e.el&&(e=t(e)),e.appendTo(n))}),r!==!1&&e.rm(),e},e.purge=function(){return e.each(function(e){"undefined"!=typeof e&&(e.el||(e=t(e)),e.purge())}),e},e.text=function(n){return e.each(function(e){"undefined"!=typeof e&&(e.el||(e=t(e)),e.text(n))}),e},e.attr=function(n,r){return e.each(function(e){"undefined"!=typeof e&&(e.el||(e=t(e)),e.attr(n,r))}),e},e.on=function(e,t){return this.each(function(n){n.addEventListener(e,t)}),this},e)},el.isArray=function(e){return Array.isArray(e)||e instanceof Array?!0:!1},el.isElementArray=function(e){return(Array.isArray(e)||e instanceof Array)&&el.isElement(e[0])?!0:!1},el.isElement=function(e){var t;try{t=e instanceof HTMLElement}catch(n){t=e&&e.nodeType?!0:!1}return t},el.isCollection=function(e){return e instanceof HTMLCollection},el.isNodeList=function(e){return e instanceof NodeList}}();var remote=require("remote"),app=remote.require("app"),Global=remote.getGlobal("sharedObject"),fs=require("fs"),escape=require("escape-html"),currentPanel={},tempUserPrefData={},writeInProgress=!1,preferencesChanged=!1,logo=el("#logo"),panel=el("#panel"),navOptions=el(".nav_option");fs.readFile("local/user-settings.json",function(e,t){writeInProgress=!0,fs.writeFile("local/temp-user-settings.json",t,function(e){writeInProgress=!1,setTimeout(function(){panel.rmClass("hide"),logo.rmClass("hide"),el("#nav").rmClass("hide"),el("html")[0].rmClass("white"),el("body")[0].rmClass("white"),el("#bottom-bar").rmClass("hide")},200)})}),el("#cancel").on("click",function(){Global.preferencesWindow.close()}),el("#save").on("click",function(e){function t(){preferencesChanged?(console.log("saving prefs"),fs.writeFile("local/user-settings.json",JSON.stringify(tempUserPrefData),function(e){e?alert("Error Saving Changes"):Global.preferencesWindow.close()})):console.log("no changes")}if(writeInProgress)var n=setInterval(function(){writeInProgress||(t(),clearInterval(n))},50);else t()}),fs.watch("local/temp-user-settings.json",function(e){console.log("You are doing a "+e+" to TEMP-user-settings.json")}),fs.watch("local/user-settings.json",function(e){console.log("You are doing a "+e+" to user-settings.json")}),el("#QTS-option").on("click",function(){panel.transitionTo("QTS"),navOptions.rmClass("current"),this.addClass("current")}),el("#files-option").on("click",function(){panel.transitionTo("files"),navOptions.rmClass("current"),this.addClass("current")}),el("#snippets-option").on("click",function(){panel.transitionTo("snippets"),navOptions.rmClass("current"),this.addClass("current")}),el("#preview-option").on("click",function(){panel.transitionTo("preview"),navOptions.rmClass("current"),this.addClass("current")}),el("#window-option").on("click",function(){panel.transitionTo("window"),navOptions.rmClass("current"),this.addClass("current")}),panel.transitionTo=function(e){panel.addClass("hide");var t=panel.buildPanel(e);panel.getPanelData(e),setTimeout(function(){panel.setPanel(t),panel.rmClass("hide")},300)},panel.getPanelData=function(e){fs.readFile("local/temp-user-settings.json",function(t,n){console.log("reading temp"),tempUserPrefData=JSON.parse(n),panel.insertData(e)})},panel.insertData=function(e){if("QTS"===e);else if("files"===e){for(var t=currentPanel.el("#path-to-brands").attr("value",tempUserPrefData.files.pathToBrands),n=currentPanel.el("#default-preview-file"),r=[],a=0,l=tempUserPrefData.files.previewFiles.length;l>a;a++){var i=tempUserPrefData.files.previewFiles,s=el("+option").attr("value",i[a].fileName).text(i[a].verboseName);i[a].fileName===tempUserPrefData.files.defaultPreviewFile&&(s.selected=!0),r.push(s)}n.append(el(r)),t.on("blur",function(){this.value!==tempUserPrefData.files.pathToBrands&&(tempUserPrefData.files.pathToBrands=this.value,panel.updateTempFile())}),currentPanel.el("#default-preview-file").on("blur",function(){console.log("checkblur"),this.options[this.selectedIndex].value!==tempUserPrefData.files.defaultPreviewFile&&(tempUserPrefData.files.defaultPreviewFile=this.options[this.selectedIndex].value,panel.updateTempFile())})}else if("snippets"===e);else if("preview"===e){currentPanel.el("#"+tempUserPrefData.preview.refreshPreview).checked=!0,currentPanel.el("#thumbnailName").attr("value",tempUserPrefData.preview.defaultThumbnailName);for(var o=currentPanel.el("#default-thumbnail-ext"),r=[],a=0,l=tempUserPrefData.preview.thumbnailExtensions.length;l>a;a++){var u=tempUserPrefData.preview.thumbnailExtensions,s=el("+option").attr("value",u[a]).text(u[a]);u[a]===tempUserPrefData.preview.defaultThumbnailExt&&(s.selected=!0),r.push(s)}o.append(el(r))}},panel.buildPanel=function(e){return"QTS"===e?currentPanel=el("+form#qtsForm").addClass("QTS").append(el("+label").text("QTS Thing").append(el("+input"))):"files"===e?(currentPanel=el("+form#filesForm").addClass("files"),currentPanel.append(el("+label").text("Path To Brands").append(el("+input#path-to-brands"))),currentPanel.append(el("+label").text("Default Preview File").append(el("+div").addClass("select_cont").append(el("+select#default-preview-file").attr("name","default-preview-file")))),currentPanel.append(el("+button").text("Manage Preview Files")),currentPanel):"snippets"===e?currentPanel=el("+form#snippetsForm").addClass("snippets").append(el("+label").text("Snippets Stuff").append(el("+input"))):"preview"===e?currentPanel=el("+form#previewForm").addClass("preview").append(el.join([el("+div").addClass("fieldSet").append(el.join([el("+h2").text("Refresh Preview Window"),el("+label").addClass(["radioLabel"]).text("On Save").append(el("+span").text(" (⌘S) ")).text(" and Command ").append(el.join([el("+span").text(" (⌘R) "),el("+input#onSave").attr("type","radio").attr("value",1).attr("name","refreshPreview")])),el("+label").addClass("radioLabel").text("On Command Only").append(el.join([el("+span").text(" (⌘R) "),el("+input#onCommand").attr("type","radio").attr("value",2).attr("name","refreshPreview")]))])),el("+div").addClass("fieldSet").append(el.join([el("+h2").text("Default Thumbnail Name"),el("+input#thumbnailName").addClass("thumbnailName").attr("name","thumbnailName"),el("+div").addClass(["select_cont","inline-block"]).append(el("+select#default-thumbnail-ext"))]))])):"window"===e?currentPanel=el("+form#windowForm").addClass("window").append(el("+label").text("Window Thing").append(el("+input"))):void 0},panel.setPanel=function(e){panel.purge().append(e),checkAndRadio()},panel.updateTempFile=function(){preferencesChanged=!0,writeInProgress=!0,console.log("updating temp"),fs.writeFile("local/temp-user-settings.json",JSON.stringify(tempUserPrefData),function(e){console.log("updated temps!"),e&&console.log(e),writeInProgress=!1})};

</script>

</body>

</html>